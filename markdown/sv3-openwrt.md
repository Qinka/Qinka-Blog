向 信步 sv3-26026 工控主板 刷 OpenWRT
===

从淘宝上买到的9成新左右的工控主板 sv3-26026，两百多块钱用来作为路由。
价格比市面上的同价位甚至跟高价位的路由器，要划算得多。然而，安装 Windows 系列的操作系统，十分愉快（草民没有亲自测试，而是一个比草民
先入手这主板的老变态，先试过了。草民最开始试过一些 Linux 的发行版
与OpenWRT然而，并不能启动，甚至还试过 Darwin与*BSD（前者，找不到镜像，后者也不启动）。后来查到了一些资料，然后找到了，合适的
OpenWRT 镜像。


# 镜像

使用的是 [恩山无线论坛中](http://www.right.com.cn/forum/thread-152879-1-3.html)
的一个镜像。这个OpenWRT 镜像是 x86 架构的 cc 版本（3.18.36内核）。
整个镜像解压之后有 1Gb之大。下载与刷的时候，最好有心理准备。

此外这个镜像的 img 文件中有两个分区，根目录在第二个分区中，只有900多Mb。
建议在写入硬盘后，及时调整大小。至于“刷”这个过程，后面还有坑。

# 写入磁盘

正常的话，建议把硬盘直接链接平时用的 PC机，而不是用 U盘。之前使用 U盘，尝试刷
Ubuntu 等发行版时，系统启动中，貌似 USB 设备就宕掉，然后就是启动不了。
所以草民在此，直接将这个镜像文件,直接
```shell
dd if=openwrt-by-linfang26-2016-08-14-x86-generic-combined-ext4.img of=/dev/sde
```
到了硬盘上。然后启动。

# 然后

然后就没有然后了。愉快时继续作死。

# 其他坑

## 登陆与访问

sv3-26026有两个网卡，一个是 LAN 另一个是 WAN。镜像会对 LAN 口接入的设备分配 ip，
而 WAN 口则无法直接访问 80 端口与 SSH 的 22 端口。解决方法只有，通过线连到 LAN 口，
此时可以将 WAN 口了连接到路由器，方便做死。 启动之后正常设置即可。

## 硬盘扩容

草民在这个地方，遇到了坑。机子都差不多配置好了，突然想起扩容。
然后虽然是正常的法子扩的容，然而还是跪了。只能再刷一次了（别问我为啥，重新刷）。
建议先扩容，再启动。

## Jffs2

这个东西，就不多说啥了，提醒各位强者，“**拔**” 硬盘的时候，尤其是，
用自己的机子通过各种方式写入镜像的时候。“弹出”的时候，一定要注意。

此外还有一个问题是，（忘记在哪里看到的了），开机后（应该是指第一次开机），需要等待
一段时间（大致是2～5min），至于为什么，是 Jffs2 有一些类似于初始化的要做，需要等待。


## Ralink 7601

草民有一个芯片是 Ralink 7601 的无线网卡，之前装树莓派的时候折腾过（但是没折腾坏啊）。
本打算用于这个主板，然而驱动并不能愉快的玩耍。

在“用这个”无线网卡之前，执行
```bash
ifconfig
```
好好的 会有 关于 `wlan0` 的内容，然而，执行
```bash
wifi detect > /etc/config/wireless
```
之后，`ifconfig -a` 里面没有 `wlan0` 。至今未破。而执行
```bash
lsusb
```
里面还是有
```
Bus 001 Device 002: ID 148f:7601 Ralink Technology, Corp
```
~~丧心病狂~~

## “插件”

~~就问你，怕不怕~~ 如果你用过 openwrt.org 官方的镜像时，你就应该知道：“**~~丧心病狂的~~某个人，向这个镜像里面添加了多少插件，然而还是有用滴~~[笑哭]~~**。”

---

<p style="text-align:right"> 李约瀚</p>
<p style="text-align:right"> 2016-09-04，西电，海棠</p>
